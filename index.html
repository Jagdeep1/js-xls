<style>
#drop{
	border:2px dashed #bbb;
	-moz-border-radius:5px;
	-webkit-border-radius:5px;
	border-radius:5px;
	padding:25px;
	text-align:center;
	font:20pt bold,"Vollkorn";color:#bbb
}
</style>
<b>JS-XLS Live Demo</b><br />
<a href="https://github.com/Niggler/js-xls">Github Repo</a><br />
<a href="https://github.com/Niggler/js-xls/issues">Issues?  Something look weird?  Click here and report an issue</a><br />

<div id="drop">Drop an XLS file here to see data in CSV.</div>
<pre id="out"></pre>
<br />
<script src="xls.js"></script>
<script src="shim.js"></script>
<script>
if(!window.cfbs) window.cfbs = {};
var drop = document.getElementById('drop');
function handleDrop(e) {
	e.stopPropagation();
	e.preventDefault();
	var files = e.dataTransfer.files;
	var i,f;
	for (i = 0, f = files[i]; i != files.length; ++i) {
		var reader = new FileReader();
		var name = f.name;
		reader.onload = function(e) {
			var data = e.target.result;
			var cfb = CFB.read(data, {type:'binary'})
			window.cfbs[name] = cfb;
			var wb = parse_xlscfb(cfb);
			var ws = wb.Sheets[wb.Directory[0]] 
			var csv = make_csv(ws);  
			var cmds = get_formulae(ws).join("\n");
			if(out.innerText === undefined) out.textContent+=csv+"\n";
			else out.innerText+=csv+"\n";

		};
		reader.readAsBinaryString(f);
	}
}

function handleDragover(e) {
	e.stopPropagation();
	e.preventDefault();
	e.dataTransfer.dropEffect = 'copy';
}

if(drop.addEventListener) {
	drop.addEventListener('dragenter', handleDragover, false);
	drop.addEventListener('dragover', handleDragover, false);
	drop.addEventListener('drop', handleDrop, false);
}
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-36810333-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
